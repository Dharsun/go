import zipfile
import re

def search_in_zip(zip_file_path, keyword_pattern):
    matched_keywords = set()

    with zipfile.ZipFile(zip_file_path, 'r') as zip_ref:
        for file_info in zip_ref.infolist():
            with zip_ref.open(file_info) as file:
                content = file.read().decode('utf-8', errors='ignore')
                matches = re.findall(keyword_pattern, content)
                matched_keywords.update(matches)

    return matched_keywords

def write_to_html(output_file, matched_keywords):
    with open(output_file, 'w') as f:
        f.write("<html><body>")
        f.write("<h2>Matched Keywords in Zip Archive</h2>")
        
        if matched_keywords:
            f.write("<ul>")
            for keyword in matched_keywords:
                f.write(f"<li>{keyword}</li>")
            f.write("</ul>")
        else:
            f.write("<p>No matches found.</p>")
        
        f.write("</body></html>")

if __name__ == "__main__":
    zip_file_path = 'path/to/your/archive.zip'
    keyword_pattern = r'your_regex_pattern_here'
    output_html_file = 'output.html'

    matched_keywords = search_in_zip(zip_file_path, keyword_pattern)

    if matched_keywords:
        print("Matched keywords:")
        for keyword in matched_keywords:
            print(keyword)
    else:
        print("No matches found.")

    write_to_html(output_html_file, matched_keywords)
